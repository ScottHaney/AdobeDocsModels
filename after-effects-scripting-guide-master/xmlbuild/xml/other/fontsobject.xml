<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.16 -->
<document source="/home/parallels/Desktop/code/AdobeDocsModels/after-effects-scripting-guide-master/docs/other/fontsobject.rst">
    <target refid="fontsobject"></target>
    <section ids="fonts-object fontsobject" names="fonts\ object fontsobject">
        <title>Fonts object</title>
        <paragraph><literal>app.fonts</literal></paragraph>
        <note>
            <paragraph>This functionality was added in After Effects 24.0.</paragraph>
        </note>
        <paragraph><strong>Description</strong></paragraph>
        <paragraph>The Fonts objects provides information about the current font ecosystem on your device.</paragraph>
        <paragraph>After Effects maintains an internal font proxy to a real font which it has enumerated in the font ecosystem. As the fonts in the font ecosystem are added and removed these internal font proxies are kept in sync as well by being added and removed.</paragraph>
        <paragraph>The properties we report via the proxy <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference> are the data that is available to us from the font files themselves, which of course will vary according to technology and type of font. It is not possible here to describe all the possible interesting variations and troubles that this causes us and in general it is advisable to be careful with assuming that the behavior and properties for one font type or technology are common to all other font types and technology - the answer as always is “it depends”.</paragraph>
        <paragraph>A <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference> is a soft reference to one of these internal font proxies and as a consequence is not sufficient to keep the internal font proxy alive. As a result if the internal font proxy is removed, the referencing <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference> will throw an invalid exception for any property reference.</paragraph>
        <paragraph>On project open, and a few other situations, it may come to pass that the font which is being referenced in the persisted data cannot be found in the current font ecosystem. In these situations an internal font proxy will be created which will contain the desired properties, such as PostScript name, and will return true for <reference internal="True" refuri="fontobject#fontobject-issubstitute"><inline classes="std std-ref">isSubstitute</inline></reference>. There will be an underlying real font which will be selected to support this internal font proxy, but we do not reveal what it is and there is no way to influence this selection.</paragraph>
        <paragraph>Continuing the open process with created substitute fonts, an attempt will be made to sync matching fonts from Creative Cloud Adobe Fonts. This is an asynchronous activity and the project will usually finish opening and be ready for use before any fonts are brought down from Adobe Fonts. Depending on how many fonts are being synced, they may be installed at different times. There is no way to disable this attempt.</paragraph>
        <paragraph>After any change to the font ecosystem from installing new real fonts, the outstanding list of substitute fonts will be evaluated to see if there now exists a real font which is a valid replacement for it - currently only requiring the PostScript name to match - and if one is found automatically all the references in the project to the substitute will be replaced with the newly installed font.</paragraph>
        <transition></transition>
        <section ids="attributes" names="attributes">
            <title>Attributes</title>
            <target refid="fontsobject-allfonts"></target>
            <section dupnames="fontsobject.allfonts" ids="fontsobject-allfonts id1" names="fontsobject.allfonts">
                <title>FontsObject.allFonts</title>
                <paragraph><literal>app.fonts.allFonts</literal></paragraph>
                <paragraph><strong>Description</strong></paragraph>
                <paragraph>The list of all the fonts currently available on your system.</paragraph>
                <paragraph>They are grouped into what is named a family group which are Arrays of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference>.</paragraph>
                <comment xml:space="preserve">Naming and ordering::</comment>
                <paragraph>The Family Name of the group is simply the <reference internal="True" refuri="fontobject#fontobject-familyname"><inline classes="std std-ref">familyName</inline></reference> of any of the <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference> in the group.</paragraph>
                <paragraph>The Family Name in one font group is not guaranteed to have unique name compared to different font groups - the grouping is determined by a number of factors including the returned value of <reference internal="True" refuri="fontobject#fontobject-technology"><inline classes="std std-ref">FontObject.technology</inline></reference> and <reference internal="True" refuri="fontobject#fontobject-writingscripts"><inline classes="std std-ref">FontObject.writingScripts</inline></reference>.</paragraph>
                <paragraph>In addition, it is perfectly acceptable to have multiple fonts with the same PostScript name, though only one will have the same (PostScript name, Technology, Primary Writing Script) tuple. In the case of true duplicates, it is undefined which will be returned and which will be suppressed.</paragraph>
                <paragraph>The family groups and <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference> in the group are sorted according to the setting in the Character Panel dropdown “Show Font Names in English”. If set to true, the <reference internal="True" refuri="fontobject#fontobject-familyname"><inline classes="std std-ref">familyName</inline></reference> and <reference internal="True" refuri="fontobject#fontobject-stylename"><inline classes="std std-ref">styleName</inline></reference> property is used, otherwise the <reference internal="True" refuri="fontobject#fontobject-nativefamilyname"><inline classes="std std-ref">nativeFamilyName</inline></reference> and <reference internal="True" refuri="fontobject#fontobject-nativestylename"><inline classes="std std-ref">nativeStyleName</inline></reference> property is used.</paragraph>
                <paragraph><reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference> for which <literal>Font.isSubstitute</literal> returns true are always sorted to the end as individual family groups.</paragraph>
                <paragraph><strong>Type</strong></paragraph>
                <paragraph>Array of Arrays of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference>; read-only.</paragraph>
                <paragraph><strong>Example</strong></paragraph>
                <paragraph>This example will select the first returned Font Family Array.</paragraph>
                <literal_block classes="code javascript" force_highlighting="False" language="javascript" linenos="False" xml:space="preserve"><inline classes="comment single">// Getting the first available Font Family Group on the system
</inline><inline classes="keyword declaration">var</inline> <inline classes="name other">firstFontGroup</inline> <inline classes="operator">=</inline> <inline classes="name other">app</inline><inline classes="punctuation">.</inline><inline classes="name other">fonts</inline><inline classes="punctuation">.</inline><inline classes="name other">allFonts</inline><inline classes="punctuation">[</inline><inline classes="literal number integer">0</inline><inline classes="punctuation">];</inline>

<inline classes="comment single">// Getting the first Style for that Font Family
</inline><inline classes="keyword declaration">var</inline> <inline classes="name other">firstFontFamilyName</inline> <inline classes="operator">=</inline> <inline classes="name other">firstFontGroup</inline><inline classes="punctuation">[</inline><inline classes="literal number integer">0</inline><inline classes="punctuation">].</inline><inline classes="name other">familyName</inline><inline classes="punctuation">;</inline>
<inline classes="keyword declaration">var</inline> <inline classes="name other">firstFamilyStyle</inline> <inline classes="operator">=</inline> <inline classes="name other">firstFontGroup</inline><inline classes="punctuation">[</inline><inline classes="literal number integer">0</inline><inline classes="punctuation">].</inline><inline classes="name other">styleName</inline><inline classes="punctuation">;</inline>

<inline classes="name other">alert</inline><inline classes="punctuation">(</inline><inline classes="name other">firstFontFamilyName</inline><inline classes="operator">+</inline><inline classes="literal string double">" "</inline><inline classes="operator">+</inline><inline classes="name other">firstFamilyStyle</inline><inline classes="punctuation">);</inline></literal_block>
                <transition></transition>
                <target refid="fontsobject-fontserverrevision"></target>
            </section>
            <section dupnames="fontsobject.fontserverrevision" ids="fontsobject-fontserverrevision id2" names="fontsobject.fontserverrevision">
                <title>FontsObject.fontServerRevision</title>
                <paragraph><literal>app.fonts.fontServerRevision</literal></paragraph>
                <note>
                    <paragraph>This functionality was added in After Effects (Beta) 24.0 and subject to change while it remains in Beta.</paragraph>
                </note>
                <paragraph><strong>Description</strong></paragraph>
                <paragraph>Returns an unsigned number representing the current revision of the font environment.</paragraph>
                <paragraph>The revision is advanced when anything happens to the font environment which would change the contents, properties, or order of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference> returned from a call to <literal>allFonts</literal>.</paragraph>
                <paragraph>Among these are: installing or removing fonts in the font environment, opening or closing a project with substituted fonts, causing a custom Variable font instance to be created, and changing the setting in the Character Panel dropdown “Show Font Names in English”.</paragraph>
                <paragraph><strong>Type</strong></paragraph>
                <paragraph>Number; read-only.</paragraph>
                <paragraph><strong>Example</strong></paragraph>
                <literal_block classes="code javascript" force_highlighting="False" language="javascript" linenos="False" xml:space="preserve"><inline classes="keyword declaration">var</inline> <inline classes="name other">fsRev</inline> <inline classes="operator">=</inline> <inline classes="name other">app</inline><inline classes="punctuation">.</inline><inline classes="name other">fonts</inline><inline classes="punctuation">.</inline><inline classes="name other">fontServerRevision</inline><inline classes="punctuation">;</inline>
<inline classes="name other">alert</inline><inline classes="punctuation">(</inline><inline classes="name other">fsRev</inline><inline classes="punctuation">);</inline></literal_block>
                <transition></transition>
                <target refid="fontsobject-fontswithdefaultdesignaxes"></target>
            </section>
            <section dupnames="fontsobject.fontswithdefaultdesignaxes" ids="fontsobject-fontswithdefaultdesignaxes id3" names="fontsobject.fontswithdefaultdesignaxes">
                <title>FontsObject.fontsWithDefaultDesignAxes</title>
                <paragraph><literal>app.fonts.fontsWithDefaultDesignAxes</literal></paragraph>
                <paragraph><strong>Description</strong></paragraph>
                <paragraph>Returns an array of variable <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference>, each using a unique font dictionary and with default values for their design axes. This API is a convenient way to quickly filter for a unique instance of each installed variable font.</paragraph>
                <paragraph><strong>Type</strong></paragraph>
                <paragraph>Array of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference>; read-only.</paragraph>
                <paragraph><strong>Example</strong></paragraph>
                <literal_block classes="code javascript" force_highlighting="False" language="javascript" linenos="False" xml:space="preserve"><inline classes="keyword declaration">var</inline> <inline classes="name other">variableFontList</inline> <inline classes="operator">=</inline> <inline classes="name other">app</inline><inline classes="punctuation">.</inline><inline classes="name other">fonts</inline><inline classes="punctuation">.</inline><inline classes="name other">fontsWithDefaultDesignAxes</inline><inline classes="punctuation">;</inline>
<inline classes="name other">alert</inline><inline classes="punctuation">(</inline><inline classes="name other">variableFontList</inline><inline classes="punctuation">.</inline><inline classes="name other">length</inline><inline classes="punctuation">);</inline></literal_block>
                <transition></transition>
                <target refid="fontsobject-missingorsubstitutedfonts"></target>
            </section>
            <section dupnames="fontsobject.missingorsubstitutedfonts" ids="fontsobject-missingorsubstitutedfonts id4" names="fontsobject.missingorsubstitutedfonts">
                <title>FontsObject.missingOrSubstitutedFonts</title>
                <paragraph><literal>app.fonts.missingOrSubstitutedFonts</literal></paragraph>
                <paragraph><strong>Description</strong></paragraph>
                <paragraph>The list of all the missing or substituted fonts of the current Project.</paragraph>
                <note>
                    <paragraph>A substituted font is a font that was already missing when the project is opened. A missing font is a font that went missing (font being uninstalled, for example) <emphasis>while</emphasis> the project was open.</paragraph>
                </note>
                <paragraph><strong>Type</strong></paragraph>
                <paragraph>Array of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference>; read-only.</paragraph>
            </section>
        </section>
        <transition></transition>
        <section ids="methods" names="methods">
            <title>Methods</title>
            <target refid="fontsobject-getfontbyid"></target>
            <section ids="fontsobject-getfontbyid id5" names="fontsobject.getfontbyid() fontsobject.getfontbyid">
                <title>FontsObject.getFontByID()</title>
                <paragraph><literal>app.fonts.getFontByID(fontID)</literal></paragraph>
                <note>
                    <paragraph>This functionality was added in After Effects (Beta) 24.0 and subject to change while it remains in Beta.</paragraph>
                </note>
                <paragraph><strong>Description</strong></paragraph>
                <paragraph>This function will return an instance of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference> based on the ID of a previously found Font.</paragraph>
                <paragraph>If no matching Font is found, it will return undefined. This can occur with an unknown ID or if the original Font has been removed from the font environment.</paragraph>
                <literal_block classes="code javascript" force_highlighting="False" language="javascript" linenos="False" xml:space="preserve"><inline classes="keyword declaration">var</inline> <inline classes="name other">font1</inline> <inline classes="operator">=</inline> <inline classes="name other">app</inline><inline classes="punctuation">.</inline><inline classes="name other">fonts</inline><inline classes="punctuation">.</inline><inline classes="name other">allFonts</inline><inline classes="punctuation">[</inline><inline classes="literal number integer">0</inline><inline classes="punctuation">][</inline><inline classes="literal number integer">0</inline><inline classes="punctuation">];</inline>
<inline classes="keyword declaration">var</inline> <inline classes="name other">font2</inline> <inline classes="operator">=</inline> <inline classes="name other">app</inline><inline classes="punctuation">.</inline><inline classes="name other">fonts</inline><inline classes="punctuation">.</inline><inline classes="name other">getFontByID</inline><inline classes="punctuation">(</inline><inline classes="name other">font1</inline><inline classes="punctuation">.</inline><inline classes="name other">fontID</inline><inline classes="punctuation">);</inline>
<inline classes="name other">alert</inline><inline classes="punctuation">(</inline><inline classes="name other">font1</inline><inline classes="punctuation">.</inline><inline classes="name other">fontID</inline> <inline classes="operator">==</inline> <inline classes="name other">font2</inline><inline classes="punctuation">.</inline><inline classes="name other">fontID</inline><inline classes="punctuation">);</inline></literal_block>
                <paragraph><strong>Parameters</strong></paragraph>
                <table>
                    <tgroup cols="2">
                        <colspec colwidth="20"></colspec>
                        <colspec colwidth="56"></colspec>
                        <tbody>
                            <row>
                                <entry>
                                    <paragraph>fontID</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>A number containing the ID of the font.</paragraph>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
                <paragraph><strong>Returns</strong></paragraph>
                <paragraph><reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference>, or undefined if no Font by that ID.</paragraph>
                <transition></transition>
                <target refid="fontsobject-getfontsbyfamilynameandstylename"></target>
            </section>
            <section ids="fontsobject-getfontsbyfamilynameandstylename id6" names="fontsobject.getfontsbyfamilynameandstylename() fontsobject.getfontsbyfamilynameandstylename">
                <title>FontsObject.getFontsByFamilyNameAndStyleName()</title>
                <paragraph><literal>app.fonts.getFontsByFamilyNameAndStyleName(familyName, styleName)</literal></paragraph>
                <paragraph><strong>Description</strong></paragraph>
                <paragraph>This function will return an array of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference> based on the Family Name and Style Name of a Font. If no suitable Font is found, it will return an empty Array.</paragraph>
                <note>
                    <paragraph>The returned array length can be more than 1 if you have multiple copies of a same font.</paragraph>
                </note>
                <literal_block classes="code javascript" force_highlighting="False" language="javascript" linenos="False" xml:space="preserve"><inline classes="keyword declaration">var</inline> <inline classes="name other">fontList</inline> <inline classes="operator">=</inline> <inline classes="name other">app</inline><inline classes="punctuation">.</inline><inline classes="name other">fonts</inline><inline classes="punctuation">.</inline><inline classes="name other">getFontsByFamilyNameAndStyleName</inline><inline classes="punctuation">(</inline><inline classes="literal string double">"Abolition"</inline><inline classes="punctuation">,</inline> <inline classes="literal string double">"Regular"</inline><inline classes="punctuation">)</inline>
<inline classes="name other">alert</inline><inline classes="punctuation">(</inline><inline classes="name other">fontList</inline><inline classes="punctuation">.</inline><inline classes="name other">length</inline><inline classes="punctuation">);</inline></literal_block>
                <paragraph><strong>Parameters</strong></paragraph>
                <table>
                    <tgroup cols="2">
                        <colspec colwidth="20"></colspec>
                        <colspec colwidth="56"></colspec>
                        <tbody>
                            <row>
                                <entry>
                                    <paragraph>FamilyName</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>A string containing the Family Name of the font.</paragraph>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <paragraph>StyleName</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>A string containing the Style Name of the font.</paragraph>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
                <paragraph><strong>Returns</strong></paragraph>
                <paragraph>Array of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference>; read-only.</paragraph>
                <transition></transition>
                <target refid="fontsobject-getfontsbypostscriptname"></target>
            </section>
            <section ids="fontsobject-getfontsbypostscriptname id7" names="fontsobject.getfontsbypostscriptname() fontsobject.getfontsbypostscriptname">
                <title>FontsObject.getFontsByPostScriptName()</title>
                <paragraph><literal>app.fonts.getFontsByPostScriptName(postscriptName)</literal></paragraph>
                <paragraph><strong>Description</strong></paragraph>
                <paragraph>This function will return an array of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference> based on the PostScript name of previously found Fonts.</paragraph>
                <paragraph>It is perfectly valid to have multiple <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference> which share the same PostScript name, the order of these is determined by the order in which they were enumerated in the font environment. The entry at <literal>[0]</literal> will be used when setting the <reference internal="True" refuri="textdocument#textdocument-fontobject"><inline classes="std std-ref">TextDocument.fontObject</inline></reference> property.</paragraph>
                <paragraph>In addition, there is a special property of this API with regards to Variable fonts. If no <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference> matching the requested PostScript exists, but we find that there exist a variable font which matches the requested PostScript name prefix, then this Variable font instance will be requested to create a matching <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font object</inline></reference>. This is the only way that we will return an instance which did not exist prior to invoking this method.</paragraph>
                <paragraph>If no matching Font is found, it will return an empty Array.</paragraph>
                <literal_block classes="code javascript" force_highlighting="False" language="javascript" linenos="False" xml:space="preserve"><inline classes="keyword declaration">var</inline> <inline classes="name other">fontList</inline> <inline classes="operator">=</inline> <inline classes="name other">app</inline><inline classes="punctuation">.</inline><inline classes="name other">fonts</inline><inline classes="punctuation">.</inline><inline classes="name other">getFontsByPostScriptName</inline><inline classes="punctuation">(</inline><inline classes="literal string double">"Abolition"</inline><inline classes="punctuation">)</inline>
<inline classes="name other">alert</inline><inline classes="punctuation">(</inline><inline classes="name other">fontList</inline><inline classes="punctuation">.</inline><inline classes="name other">length</inline><inline classes="punctuation">);</inline></literal_block>
                <paragraph><strong>Parameters</strong></paragraph>
                <table>
                    <tgroup cols="2">
                        <colspec colwidth="20"></colspec>
                        <colspec colwidth="56"></colspec>
                        <tbody>
                            <row>
                                <entry>
                                    <paragraph>postscriptName</paragraph>
                                </entry>
                                <entry>
                                    <paragraph>A string containing the PostScript Name of the font.</paragraph>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
                <paragraph><strong>Returns</strong></paragraph>
                <paragraph>Array of <reference internal="True" refuri="fontobject#fontobject"><inline classes="std std-ref">Font objects</inline></reference>; read-only.</paragraph>
            </section>
        </section>
    </section>
</document>
